
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Extrapolation Methods &#8212; taxdata</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" href="../../_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Extrapolation of 2009 PUF" href="Stage1_Stage2_2009PUF.html" />
    <link rel="prev" title="Overview of Statistical Matching" href="MatchingDocumentationRevised.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../../index.html">
      
      
      
      <h1 class="site-logo" id="site-title">taxdata</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../index.html">
                    About taxdata
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Contributing to taxdata
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../contributing/CONTRIBUTING.html">
   TaxData Contributor Guide
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  taxdata Data
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../data/datasets.html">
   TaxData Dataset Documentation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../data/about_puf_data.html">
   About IRS Public Use Data
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../data/puf_file_doc.html">
   Current Population Survey Tax Unit File Documentation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../data/about_cps_data.html">
   About CPS Data
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../data/cps_file_doc.html">
   Current Population Survey Tax Unit File Documentation
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  taxdata Methodology
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="CBO_Baseline_Updating_Instructions.html">
   Updating the CBO Baseline
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="SOI_Estimates_Updating_Instructions.html">
   Updating the SOI Estimates
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="MATCH.html">
   CPS Match File documentation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="MatchingDocumentationRevised.html">
   Overview of Statistical Matching
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Extrapolation Methods
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Stage1_Stage2_2009PUF.html">
   Extrapolation of 2009 PUF
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="puf_stage3.html">
   Stage III Documentation
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  About
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../about/roadmap.html">
   Roadmap
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../about/LICENSE.html">
   CC0 1.0 Universal Summary
  </a>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-repository-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Source repositories">
      <i class="fab fa-github"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://github.com/PSLmodels/taxdata"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Source repository"
>
  

<span class="headerbtn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="headerbtn__text-container">repository</span>
</a>

      </li>
      
      <li>
        <a href="https://github.com/PSLmodels/taxdata/issues/new?title=Issue%20on%20page%20%2Fcontent/methods/Stage1_Stage2_Methodology.html&body=Your%20issue%20content%20here."
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Open an issue"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="headerbtn__text-container">open issue</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="../../_sources/content/methods/Stage1_Stage2_Methodology.md"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.md</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#">
   Extrapolation Methods
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#overview">
   Overview
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#extrapolating-microdata-files">
   EXTRAPOLATING MICRODATA FILES
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#stage-1">
     STAGE 1
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#stage-ii">
     STAGE II
    </a>
   </li>
  </ul>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Extrapolation Methods</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#">
   Extrapolation Methods
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#overview">
   Overview
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#extrapolating-microdata-files">
   EXTRAPOLATING MICRODATA FILES
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#stage-1">
     STAGE 1
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#stage-ii">
     STAGE II
    </a>
   </li>
  </ul>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section class="tex2jax_ignore mathjax_ignore" id="extrapolation-methods">
<h1>Extrapolation Methods<a class="headerlink" href="#extrapolation-methods" title="Permalink to this headline">#</a></h1>
<p>In this memorandum we describe a methodology for extrapolating, or aging, microdata files for several years into the future. While the procedures can be applied to any type of microdata, we pay special attention to the unique challenges faced when dealing with individual income tax data. These data will include, for example, administrative tax return records and samples such as the Statistics of Income (SOI) Public Use File (PUF).</p>
<p>It is useful and occasionally necessary to make a distinction between the methodology we employ to age the data and the development of the macroeconomic forecasts that we would like the data to represent. We treat both here.
After a brief overview, we first describe a methodology that we have used successfully for 20 years in support of microsimulation modeling at the federal and state level. In the second section, we illustrate how some simple macroeconomic forecasts might be developed.</p>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="overview">
<h1>Overview<a class="headerlink" href="#overview" title="Permalink to this headline">#</a></h1>
<p>Most microdata, whether from administrative sources or surveys, become available with a time lag. This is especially true of individual income tax data where there may be several years between the time the data are collected and eventually released to researchers. In contrast, most public policy models are forward-looking and aim to provide estimates of how a particular tax or spending policy will affect the economy in the near- to mid- term. In tax policy, it is often required to provide estimates of the budgetary effect for 10 years into the future.</p>
<p>Historically, tax policy analysts at the Treasury’s Office of Tax Analysis (OTA) and the Congressional Joint Committee on Taxation (JCT) have employed a variety of methods to extrapolate their underlying microsimulation models many years into the future. These methods are generally referred to as “static aging”, and the terminology relates to the fact that the procedures impose no intertemporal linkages across records or over time. Put somewhat differently, when static aging is used to extrapolate a microdata file t years into the future, it is not necessary to age the data for the intervening t-1 years.<a class="footnote-reference brackets" href="#footnote1" id="id1">1</a></p>
<p>Generally speaking, static aging methods are implemented in two distinct steps. In the first step (Stage I), income and deduction items are adjusted to reflect forecasts of inflation from the base year to the simulation year. In the second step (Stage II), numerical optimization procedures are used to re-weight the file with the goal of hitting externally imposed control totals.</p>
<p>In what follows, we assume that a set of forecasts has been obtained and we wish to age our base year data to match these forecasts. The forecasts are generally supplied, or derived from, some external macroeconomic forecast (e.g., economic projections supplied by the Congressional Budget Office (CBO)). In addition, some forecasts of underlying tax variables are supplied by analysts or may be derived from other, special- purpose economic models. Later we outline one way in which targets can be identified and estimated.</p>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="extrapolating-microdata-files">
<h1>EXTRAPOLATING MICRODATA FILES<a class="headerlink" href="#extrapolating-microdata-files" title="Permalink to this headline">#</a></h1>
<p>In most microsimulation models used for policy analysis, the underlying data comes from a survey of relevant economic units or from a sample of administrative records. These samples will be representative of the population of interest (the sample frame) and each record on the file is assigned a sample weight that is derived from the sample design.<a class="footnote-reference brackets" href="#footnote2" id="id2">2</a> The sum of the sample weights on the file represents an estimate of the population. Likewise, weighted totals of income items represent an estimate of the population total in the year the sample was chosen.</p>
<p>Microsimulation is a bottom-up approach to policy analysis and aggregate, macroeconomic outcomes are calculated by summing-up the individual outcomes from the constituent micro units that comprise the model. In order for these aggregate outcomes to be closely aligned with an external forecast of the macro economy, we must pay attention to how both the individual variables on the file age adjusted over time and how the sample weights change over the time horizon.</p>
<section id="stage-1">
<h2>STAGE 1<a class="headerlink" href="#stage-1" title="Permalink to this headline">#</a></h2>
<p>In the first phase of the extrapolation process we adjust the individual data elements on the base year file on a record-by-record basis to correspond with our macroeconomic forecast. Specifically, we multiply each data element on the file by a per capita adjustment factor that ensures that our macro targets will be hit. These adjustment factors (the “Stage I” factors) are calculated as follows. Define the following variables:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(X_0\)</span>: the value of some macroeconomic aggregate in the base year (e.g., wages)</p></li>
<li><p><span class="math notranslate nohighlight">\(P_0\)</span>: the population total in the base year (e.g., number of tax returns)</p></li>
<li><p><span class="math notranslate nohighlight">\(w_{i0}\)</span>: sample weight of the ith unit in the base year</p></li>
<li><p><span class="math notranslate nohighlight">\(x_{i0}\)</span>: observed value of variable x reported by unit i in the base year.</p></li>
</ul>
<p>With this notation, we have the following relationships that link the macro and micro variables:<a class="footnote-reference brackets" href="#footnote3" id="id3">3</a></p>
<div class="math notranslate nohighlight" id="equation-eqn-p0">
<span class="eqno">(1)<a class="headerlink" href="#equation-eqn-p0" title="Permalink to this equation">#</a></span>\[\sum w_{i0} = P_0\]</div>
<div class="math notranslate nohighlight" id="equation-eqn-x0">
<span class="eqno">(2)<a class="headerlink" href="#equation-eqn-x0" title="Permalink to this equation">#</a></span>\[\sum x_{i0} * w_{i0} = X_0\]</div>
<p>Now suppose we have some externally supplied forecast for total population and the aggregate level of our macro variable for some year t:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(X_t\)</span>: the forecasted value of our macroeconomic aggregate in year t</p></li>
<li><p><span class="math notranslate nohighlight">\(P_t\)</span>: the forecasted population total in year t.</p></li>
</ul>
<p>Define the following growth rates from the base year to year t:</p>
<div class="math notranslate nohighlight" id="equation-eqn-1pr">
<span class="eqno">(3)<a class="headerlink" href="#equation-eqn-1pr" title="Permalink to this equation">#</a></span>\[(1 + r) = \frac{X_t}{X_0}\]</div>
<div class="math notranslate nohighlight" id="equation-eqn-1pp">
<span class="eqno">(4)<a class="headerlink" href="#equation-eqn-1pp" title="Permalink to this equation">#</a></span>\[(1 + p) = \frac{P_t}{P_0}\]</div>
<div class="math notranslate nohighlight" id="equation-eqn-1prho">
<span class="eqno">(5)<a class="headerlink" href="#equation-eqn-1prho" title="Permalink to this equation">#</a></span>\[(1 + \rho) = \frac{(1+r)}{(1+p)} \text{  per capital adjustment}\]</div>
<p>To perform the Stage I adjustment to the microdata on our base year file we first apply the population growth factor to the base year sample weights on the file, and second, apply the per capita adjustment factor to the reported base year income on each record. That is, we calculate</p>
<div class="math notranslate nohighlight" id="equation-eqn-wit">
<span class="eqno">(6)<a class="headerlink" href="#equation-eqn-wit" title="Permalink to this equation">#</a></span>\[w_{it} = w_{i0} * (1 + p)\]</div>
<div class="math notranslate nohighlight" id="equation-eqn-xit">
<span class="eqno">(7)<a class="headerlink" href="#equation-eqn-xit" title="Permalink to this equation">#</a></span>\[x_{it} = x_{i0} * (1 + \rho)\]</div>
<p>This ensures that our macro targets are hit in year t. That is, for population we calculate:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{align}
\sum w_{it}&amp; = \sum w_{i0} * (1 + p) \\
&amp; = (1 + p)\sum w_{i0} \\
&amp; = \frac{P_t}{P_0}\sum w_{i0} \\
&amp; = P_t
\end{align}
\end{split}\]</div>
<p>The first equality is from the definition in <a class="reference internal" href="#equation-eqn-wit">(6)</a>; the second equality is due to the distributive property; the third equality is from the definition in <a class="reference internal" href="#equation-eqn-1pp">(4)</a>; and the final result is from <a class="reference internal" href="#equation-eqn-p0">(1)</a>. Similarly, our aggregate macro target is achieved:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{align}
\sum x_{it} * w_{it}&amp; = \sum x_{i0} (1 + \rho) * w_{i0} (1+p) \\
&amp; = (1 + p)(1+\rho) \sum x_{i0}* w_{i0} \\
&amp; = (1 + r) \sum x_{i0}* w_{i0} \\
&amp; = (1 + r) X_0 \\
&amp; = X_t
\end{align}
\end{split}\]</div>
<p>where the first equality defines the Stage I adjustment; the second is from the distributive
law; the third is from <a class="reference internal" href="#equation-eqn-1prho">(5)</a>; the fourth is from <a class="reference internal" href="#equation-eqn-x0">(2)</a>; and the final equality is from <a class="reference internal" href="#equation-eqn-1pr">(3)</a>.</p>
<p>The procedure outlined above is easily extended to accommodate any number of macroeconomic targets coupled with their micro variables and the methodology guarantees that all the targets are reached exactly. We point out that most microsimulation models stop here and perform no other adjustments to the data. However, experience has shown that while this methodology is sufficient to reach any exogenous target, certain endogenous, or jointly determined variables, may need further calibration, especially if the aging is done for more than a few years into the feature. In the next section, we describe a set of additional adjustments that ensure that both the exogenous and endogenous targets are reached.</p>
</section>
<section id="stage-ii">
<h2>STAGE II<a class="headerlink" href="#stage-ii" title="Permalink to this headline">#</a></h2>
<p>In the second stage of the extrapolation process, numerical optimization methods are used to adjust the sample weights on the file to ensure all targets are reached. We rely on a linear programming algorithm to solve for a new set of (sample) weights that minimize the absolute value of the percentage change in the weight for each record on the file subject to the constraint that each of the targets are reached.</p>
<p>Mathematically, we let <span class="math notranslate nohighlight">\(z_i\)</span> represent the percentage change in the sample weight for record i on the file relative to the base year sample weight:</p>
<div class="math notranslate nohighlight">
\[
w_{it} = w_{i0}(1+z_i)
\]</div>
<p>Furthermore, to accommodate the absolute value metric, we decompose the zi into a positive and negative component by defining:</p>
<div class="math notranslate nohighlight" id="equation-eqn-ri">
<span class="eqno">(8)<a class="headerlink" href="#equation-eqn-ri" title="Permalink to this equation">#</a></span>\[r_i = z_i^+\]</div>
<div class="math notranslate nohighlight" id="equation-eqn-si">
<span class="eqno">(9)<a class="headerlink" href="#equation-eqn-si" title="Permalink to this equation">#</a></span>\[s_i = z_i^-\]</div>
<div class="math notranslate nohighlight" id="equation-eqn-zi">
<span class="eqno">(10)<a class="headerlink" href="#equation-eqn-zi" title="Permalink to this equation">#</a></span>\[z_i = r_i - s_i\]</div>
<p>Here, <a class="reference internal" href="#equation-eqn-ri">(8)</a> and <a class="reference internal" href="#equation-eqn-si">(9)</a> define the positive and negative parts, respectively, of the zi and this leads to the definition of the absolute value:</p>
<div class="math notranslate nohighlight" id="equation-eqn-abs-zi">
<span class="eqno">(11)<a class="headerlink" href="#equation-eqn-abs-zi" title="Permalink to this equation">#</a></span>\[|z_i| = r_i + s_i\]</div>
<p>Our linear programming problem then becomes one of choosing the smallest <span class="math notranslate nohighlight">\(\delta\)</span> that solves:</p>
<div class="math notranslate nohighlight" id="equation-eqn-obj-func">
<span class="eqno">(12)<a class="headerlink" href="#equation-eqn-obj-func" title="Permalink to this equation">#</a></span>\[\min_{(r,s)} \sum |z_i| = \sum (r_i + s_i)\]</div>
<p>subject to:</p>
<div class="math notranslate nohighlight" id="equation-eqn-const1">
<span class="eqno">(13)<a class="headerlink" href="#equation-eqn-const1" title="Permalink to this equation">#</a></span>\[0 \leq |z_i| \leq \delta\]</div>
<p>and</p>
<div class="math notranslate nohighlight" id="equation-eqn-const2">
<span class="eqno">(14)<a class="headerlink" href="#equation-eqn-const2" title="Permalink to this equation">#</a></span>\[Ax=b\]</div>
<p>where <span class="math notranslate nohighlight">\(x \in (r_i,s_i)\)</span> are the variables to be solved for, A is a coefficient matrix that will
depend on the specific targets and b is a target vector.</p>
<p>This procedure is flexible enough to handle many types of targets. In practice, we have usually incorporated four types of constraints:</p>
<ol class="simple">
<li><p>Amount Aggregates (AA)</p></li>
<li><p>Return Aggregates (RA)</p></li>
<li><p>Amount by Income Class (AB)</p></li>
<li><p>Returns by Income Class (RB)</p></li>
</ol>
<p>An example of an amount aggregate (AA) target might be total capital gains; a return aggregate (RA) might be the total number of taxpayers reporting capital gains<a class="footnote-reference brackets" href="#footnote4" id="id4">4</a>; and targeting both these variables by income class would constitute AB and RB targets, respectively.</p>
<p>Here, in no particular order, are some observations we have made over the years in using this Stage II procedure:</p>
<ul class="simple">
<li><p>Solving the linear programming (LP) formulation of this problem means doubling the number of variables that need to be solved for (the <span class="math notranslate nohighlight">\(r_i\)</span>’s and <span class="math notranslate nohighlight">\(s_i\)</span>’s). Our view is that this is a small price to pay for the assurance that the optimum is achieved under the LP framework.</p></li>
<li><p>It may take several iterations of the algorithm to achieve a solution that is acceptable by iterating over <span class="math notranslate nohighlight">\(\delta\)</span>.</p></li>
<li><p>Not all variables in the model will (or should) be targeted. Those that aren’t will only receive a Stage I adjustment. In fact, after the LP problem is solved, most returns on the file will receive only a Stage I adjustment. That is, <span class="math notranslate nohighlight">\(z_i\)</span> will be zero for most records.</p></li>
<li><p>Experience with this algorithm has show that it is reasonable stable over the forecasting horizon.</p></li>
<li><p>More importantly, those variables that are not targeted in the Stage II extrapolation remain reasonably close to their Stage I values. Put differently, the reweighting does not materially affect the values of these variables.</p></li>
<li><p>In practice, when solving the LP, we usually use the solution for year t as the starting point for obtaining a solution for year t+1. This speeds up the LP algorithm substantially.</p></li>
</ul>
<hr class="footnotes docutils" />
<dl class="footnote brackets">
<dt class="label" id="footnote1"><span class="brackets"><a class="fn-backref" href="#id1">1</a></span></dt>
<dd><p>This is in contrast to dynamic microsimulation models where outcomes for year t will directly influence the outcomes in year t+1 for each micro unit.</p>
</dd>
<dt class="label" id="footnote2"><span class="brackets"><a class="fn-backref" href="#id2">2</a></span></dt>
<dd><p>In a stratified sample design, the sample weight is generally calculated as the ratio of the population within a particular strata to the sample size in that strata.</p>
</dd>
<dt class="label" id="footnote3"><span class="brackets"><a class="fn-backref" href="#id3">3</a></span></dt>
<dd><p>In practice, the value of <span class="math notranslate nohighlight">\(X_0\)</span> may represent a different concept that what appears in the microdata. For
example, wages on the tax return may not include some types of employee compensation that is measured at the macro level.</p>
</dd>
<dt class="label" id="footnote4"><span class="brackets"><a class="fn-backref" href="#id4">4</a></span></dt>
<dd><p>Targeting both, of course, would be the same as targeting average capital gains.</p>
</dd>
</dl>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./content/methods"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="MatchingDocumentationRevised.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Overview of Statistical Matching</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="Stage1_Stage2_2009PUF.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Extrapolation of 2009 PUF</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By Anderson Frailey<br/>
  
      &copy; Copyright 2021.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>